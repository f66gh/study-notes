# cookie session token

我们都知道http协议本身是一种无状态的协议，一个普通的请求大致分为三步：

1、客户端发送请求给服务器 

2、服务器处理该请求

3、服务器将处理结果响应该客户端。

javaweb中有两种实现会话的机制：

1）Cookie机制

2）Session机制

PS：cookie和session是浏览器与服务器交互的一种规范，有专门的的组织对该规范进行定义，只要浏览器或服务器遵守了该规范，我们就能使用cookie和session。其他能做web开发的高级语言也有，只是实现方式不同罢了。

# 一、cookie机制

## 1、基本介绍

1）cookie机制采用的是**在客户端保持 HTTP 状态信息的方案。**当浏览器访问WEB服务器的某个资源时，WEB服务器会**在HTTP响应头中添加一个键值对传送给浏览器**，再由浏览器将该cookie**放到客户端磁盘的一个文件中**，该文件可理解为cookie域(键值对的集合)，往后每次访问某个网站时，都会在**请求头中带着这个网站的所有cookie值**。（至于怎么区分不同网站的cookie的，很简单，每个网站都给他一个唯一标识比如网址等，每次打开某网址时，就**查询该网站下的**所有cookie值即可。）

2）每一个cookie都有一个name和一个value，且name是唯一的。相同名字时，后者会覆盖掉前者（类似哈希表的key的效果）。

3）一个WEB浏览器也可以存储多个WEB站点提供的Cookie。浏览器一般只允许存放300个Cookie，每个站点最多存放20个Cookie，每个Cookie的大小限制为4KB。

## 2、分类

### 1）会话级别的cookie

**默认情况下它是一个会话级别的cookie,存储在浏览器的内存中，用户退出浏览器之后被删除。**

### 2）持久化的cookie

若希望浏览器将该cookie存储在磁盘上，则需要设置该cookie的生命周期**setMaxAge**，并给出一个以**秒**为单位的时间。将最大时效设为0则是命令浏览器删除该cookie。

## 3、cookie的作用域

cookie的**domain**和**path**属性定义了cookie的作用范围，即访问哪些网站或url时，会自动的带着该cookie。domain即域名，默认是当前主机(不包括子域名)，path默认是*(所有路径)，即域名后面的的路径。大部分情况下我们都是使用默认的设置即可。

## 4、基本原理

当一个浏览器访问某web服务器时，web服务器会调用HttpServletResponse的**addCookie()**方法，在响应头中添加一个名叫**Set-Cookie**的响应字段用于将Cookie返回给浏览器，**当浏览器第二次访问该web服务器时会自动的将该cookie回传给服务器，来实现用户状态跟踪。**